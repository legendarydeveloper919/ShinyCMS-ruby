<% @page_title = t( '.title', name: @profile.name ) %>

<%= form_for @profile, url: shiny_profiles.profile_path( @profile.username ), method: :put do |f| %>
  <p>
    <%= f.label :public_name %>
    <br><%= f.text_field :public_name %>
  </p>

  <p>
    <%= f.label :public_email %>
    <br><%= f.text_field :public_email %>
  </p>

  <p>
    <%= f.label :profile_pic %>
    <br><%= f.file_field :profile_pic %>
    <% if @profile.profile_pic.attached? %>
    <br><%= image_tag url_for( @profile.profile_pic.variant( resize: '200x200!' ) ), class: 'user_icon' %>
    <% end %>
  </p>

  <p>
    <%= f.label :bio %>
    <br><%= f.text_area :bio %>
  </p>

  <p>
    <%= f.label :location %>
    <br><%= f.text_field :location %>
  </p>
  <p>
    <%= f.label :postcode %>
    <br><%= f.text_field :postcode, class: 'textshort' %>
  </p>

  <p>
    <%= label_tag 'Links' %>
  </p>
  <%= hidden_field_tag :sort_order, '', id: :sort_order %>
  <span id="sortable">
    <%= f.fields_for :links do |fields| %>
    <% this = @profile.links[fields.index] %>
    <p id="sorted_<%= this.id %>">
      <%= fields.text_field :name, placeholder: 'Name' %>
      <%= fields.text_field :url,  placeholder: 'URL'  %>
      <i class="handle cil-elevator"></i>
    </p>
    <% end %>
  </span>
  <p>
    <%= text_field_tag 'profile[new_link_name]', nil, placeholder: 'Name' %>
    <%= text_field_tag 'profile[new_link_url]',  nil, placeholder: 'URL'  %>
  </p>

  <p class="top-margin">
    <%= submit_tag t( 'update' ) %>
  </p>
<% end %>
